<!-- {% load static %} -->
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Sora:wght@100..800&display=swap"
			rel="stylesheet"
		/>
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
			rel="stylesheet"
			integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
			crossorigin="anonymous"
		/>
		<link rel="stylesheet" href="../static/css/style.css" />
		<title>Login</title>
	</head>
	<body>
		<div class="overlay"></div>
		<div class="mobile-nav">
			<div class="flex-between">
			  <a href="{% url 'login' %}" class="login-cta">Login/Register</a>
			  <span class="cancel-icon flex-center">
				<svg
				  width="54"
				  height="54"
				  viewBox="0 0 54 54"
				  fill="none"
				  xmlns="http://www.w3.org/2000/svg"
				>
				  <path
					d="M27 0C12.0789 0 0 12.0789 0 27C0 41.9211 12.0789 54 27 54C41.9211 54 54 41.9211 54 27C54 12.0789 41.9211 0 27 0ZM27 51.1579C13.6421 51.1579 2.84211 40.3579 2.84211 27C2.84211 13.6421 13.6421 2.84211 27 2.84211C40.3579 2.84211 51.1579 13.6421 51.1579 27C51.1579 40.3579 40.3579 51.1579 27 51.1579ZM28.9895 27L37.9421 18.0474C38.5105 17.4789 38.5105 16.6263 37.9421 16.0579C37.3737 15.4895 36.521 15.4895 35.9526 16.0579L27 25.0105L18.0474 16.0579C17.4789 15.4895 16.6263 15.4895 16.0579 16.0579C15.4895 16.6263 15.4895 17.4789 16.0579 18.0474L25.0105 27L16.0579 35.9526C15.4895 36.521 15.4895 37.3737 16.0579 37.9421C16.6263 38.5105 17.4789 38.5105 18.0474 37.9421L27 28.9895L35.9526 37.9421C36.521 38.5105 37.3737 38.5105 37.9421 37.9421C38.5105 37.3737 38.5105 36.521 37.9421 35.9526L28.9895 27Z"
					fill="#9835EF"
				  />
				</svg>
			  </span>
			</div>
	  
			<ul class="mobile-nav-links-container flex-column gp-15 mt-5">
			  <li><a href="/" class="mobile-nav-link">Home</a></li>
			  <li><a href="{% url "find_campaign" %}" class="mobile-nav-link">Find campaign</a></li>
			  <li><a href="{% url "start_campaign" %}" class="mobile-nav-link">Start campaign</a></li>
			  <li><a href="{% url 'profile' %}" class="mobile-nav-link">Profile</a></li>
			  <li><a href="#" class="mobile-nav-link">About</a></li>
			  <li><a href="#" class="mobile-nav-link">FAQ</a></li>
			  <li><a href="#" class="mobile-nav-link">Fees & Payment</a></li>
			  <li><a href="#" class="mobile-nav-link">Support</a></li>
			</ul>
		  </div>
		<div class="login acct page">
			<nav class="navbar bos sticky-top align-items-center">
				<div class="container">
					<a href="/">
						<img class="logo-img" src="{% static '../static/img/Feed-logo.png' %}" alt="logo img" />
					</a>
					
					<div class="nav-util-cta-container d-flex align-items-center gap-4">
                        <button
                            class="search-icon-btn"
                            >
                            <img class="search-icon"  src="{% static '../static/img/svg/search-icon.svg' %}"
                            alt="search icon">
                        </button>
                        <a href="{% url 'start_campaign' %}" class="start-camp-cta">START CAMPAIGN</a>
					
					</div>
					<div class="hamburger">
						<span></span>
						<span></span>
						<span></span>
					</div>

					<!-- <div class="nav-cta-container d-flex">
		</div> -->
				</div>
				<span class="page-highlight-span">Login</span>
			</nav>

			<main class="light-bg-clr">
				<h2 class="page-head">Log in to your profile</h2>
				<p class="mac-text-large acct-desc">
					Log in to your Feed Needs Without Borders profile below. Donâ€™t have
					one? <a href="{% url 'signup' %}" class="highlight-span-clr">Sign up here.</a>
				</p>
				<p class="mac-text-large return-desc">
					Returning user with an existing campaign?
					<a href="{% url 'forget' %}" class="highlight-span-clr"> Set new password here.</a>
				</p>

				<div class="acct-form-container">
					<h3 class="page-sub-head highlight-span-clr text-center">
						Profile Details
					</h3>
					<form data-attr="acct-form-el" method="post" class="flex-column gp-20 mt-4">
						{% csrf_token %}
						<div class="flex-column w-100">
							<input
								class="acct-input"
								type="email"
								name="email"
								placeholder="Email *"
							/>
							<span class="error-message"></span>
						</div>

						<div class="flex-column w-100">
							<input
								class="acct-input"
								type="password"
								name="password"
								placeholder="Password *"
							/>
							<span class="error-message"></span>

						</div>
					
					<a href="{% url 'forget' %}" class="forgot-pass-cta">Forgot password?</a>
				</div>

				<button type ="button" class="cta-btn submit-btn">LOG IN TO YOUR PROFILE</button>
			</form>
			</main>

			<footer class="pos-rel mt-5 util-pg-2 ">
				<div class="footer-bottom-wrapper">
					<div class="w-100">
						<div class="flex-wrap gp-20 footer-bottom-link-container mt-5">
							<a href="#" class="footer-bottom-link">Privacy Policy</a>
							<a href="#" class="footer-bottom-link">Terms & Conditions</a>
							<div class="social-media-container flex-wrap">
								<a href="#" class="flex-center">
									<img
										class="social-icon"
										src="../static/img/svg/socials/facebook.svg"
										alt="Facebook icon"
									/>
								</a>

								<a href="#" class="flex-center">
									<img
										class="social-icon"
										src="../static/img/svg/socials/twitter.svg"
										alt="Twitter icon"
									/>
								</a>

								<a href="#" class="flex-center">
									<img
										class="social-icon"
										src="../static/img/svg/socials/instagram.svg"
										alt="Instagram icon"
									/>
								</a>

								<a href="#" class="flex-center">
									<img
										class="social-icon"
										src="../static/img/svg/socials/linkedIn.svg"
										alt="LinkedIn icon"
									/>
								</a>

								<a href="#" class="flex-center">
									<img
										class="social-icon"
										src="../static/img/svg/socials/tiktok.svg"
										alt="Tiktok icon"
									/>
								</a>

								<a href="#" class="flex-center">
									<img
										class="social-icon"
										src="../static/img/svg/socials/whatsapp.svg"
										alt="Whatsapp icon"
									/>
								</a>

								<a href="#" class="flex-center">
									<img
										class="social-icon"
										src="../static/img/svg/socials/telegram.svg"
										alt="Telegram icon"
									/>
								</a>

								<a href="#" class="flex-center">
									<img
										class="social-icon"
										src="../static/img/svg/socials/youtube.svg"
										alt="Youtube icon"
									/>
								</a>
							</div>
							<div class="copyright-container pos-rel flex gp-15">
								<p class="copyright-text">2024 Feed Needs</p>
								<span class="dash"></span>
								<p class="copyright-text">All rights reserved</p>
							</div>
						</div>
					</div>
				</div>
			</footer>
		</div>
		<script>
			const hamburger = document.querySelector(".hamburger");
			const cancelIcon = document.querySelector(".mobile-nav .cancel-icon");
			const overlay = document.querySelector(".overlay");
			const mobileNav = document.querySelector(".mobile-nav");
			const submitBtn = document.querySelector(".cta-btn.submit-btn");
			const acctForm = document.querySelector("[data-attr = 'acct-form-el']");
			if (hamburger) {
				hamburger.addEventListener("click", function () {
					overlay.classList.add("visible");
					mobileNav.classList.add("slideIn");
					document.body.classList.add("hide-overflow");
				});
			}

			if (cancelIcon){
				cancelIcon.addEventListener("click", function () {
					overlay.classList.remove("visible");
					mobileNav.classList.remove("slideIn");
					document.body.classList.remove("hide-overflow");
				})
			}

			const inputs = acctForm.querySelectorAll(".acct-input");

			// Attach event listeners to each input for clearing error messages on focus
			inputs.forEach(input => {
				input.addEventListener("focus", clearErrorMessage);
				input.addEventListener("input", () => validateSingleField(input)); // Validate on user input
			});

			// Validate all fields before form submission
			function validateField(form) {
				const inputs = form.querySelectorAll(".acct-input");
				let isValid = true;

				inputs.forEach(input => {
					if (input.value.trim() === "" || !input.checkValidity()) {
						showErrorMessage(input, getErrorMessage(input));
						isValid = false;
					}
				});

				return isValid;
			}

			// Get specific error messages based on input validation state
			function getErrorMessage(input) {
				if (input.validity.valueMissing) {
					return "This field is required.";
				}
				if (input.validity.typeMismatch) {
					if (input.type === "email") {
						return "Invalid email address.";
					}
					return "Please enter a valid value.";
				}
				if (input.validity.tooShort) {
					return `Please lengthen this text to ${input.minLength} characters or more.`;
				}
				return "Invalid input.";
			}

			// Show error message below the input
			function showErrorMessage(input, msg) {
				let errorMessage = input.nextElementSibling;

				// Create error message element if it doesn't exist
				if (!errorMessage || !errorMessage.classList.contains("error-message")) {
					errorMessage = document.createElement("div");
					errorMessage.className = "error-message";
					input.parentNode.insertBefore(errorMessage, input.nextSibling);
				}

				errorMessage.textContent = msg;
				errorMessage.style.display = "block";
			}

			// Clear error message when user focuses on the input
			function clearErrorMessage(event) {
				const errorMessage = event.target.nextElementSibling;

				if (errorMessage && errorMessage.classList.contains("error-message")) {
					errorMessage.style.display = "none";
				}
			}

			// Validate a single input field dynamically
			function validateSingleField(input) {
				if (input.value.trim() === "" || !input.checkValidity()) {
					showErrorMessage(input, getErrorMessage(input));
				} else {
					clearErrorMessage({ target: input });
				}
			}

			// Handle form submission
			if (submitBtn && acctForm) {
				submitBtn.addEventListener("click", function (e) {
					e.preventDefault(); // Prevent default form submission
					if (validateField(acctForm)) {
						acctForm.submit(); // Submit form only if all inputs are valid
					}
				});
			}

		</script>

		<script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
		{% if messages %}
		<script>
			const messages = [
				{% for message in messages %}
					{
						message: "{{ message }}",
						tags: "{{ message.tags }}"
					},
				{% endfor %}
			];
		
			messages.forEach((msg) => {
				const customElement = document.createElement("div");
				customElement.className = "custom-toast";
		
				// Add content to the custom element
				const img = document.createElement("img");
				img.alt = "Notification Icon";
		
				const messageText = document.createElement("div");
				messageText.className = "message";
				messageText.innerText = msg.message;
		
				// Adjust style based on tag
				const isSuccess = msg.tags.includes("success");
				customElement.style.setProperty("--toast-clr", isSuccess ? "green" : "red");
				img.src = isSuccess 
					? "{% static 'img/svg/check-green.svg' %}" 
					: "{% static 'img/svg/info-red.svg' %}";
		
				customElement.appendChild(img);
				customElement.appendChild(messageText);
		
				// Show toast with custom element
				Toastify({
					node: customElement,
					duration: 5500,
					gravity: "top", // Ensure it appears at the top
					position: "right",  // Ensure it appears at the right
					close : true,
					style: {
						background: "white",
						borderRadius: "8px",
						padding: "0px",
						maxWidth: "350px", // Restrict the width
					},
				}).showToast();
			});
		</script>
		{% endif %}
		
	</body>
</html>
